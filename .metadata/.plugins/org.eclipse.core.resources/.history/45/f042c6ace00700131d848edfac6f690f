package Generator;

import PixelPoint;

import java.io.FileOutputStream;
import java.io.IOException;

import com.example.aworkshop.SettingsActivity;

import ActivationManager.EventCandidate;
import ActivationManager.EventCandidateContainer;
import Common.Photo;
import android.R.integer;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Rect;
import android.os.Build;

public class MapCollageBuilder {
	
	public void BuildCollage(Template template) {
		
		Canvas canvas = null;
		FileOutputStream fos = null;
		Bitmap bmpBase = null;

		bmpBase = Bitmap.createBitmap(3264, 2448, Bitmap.Config.RGB_565);
		canvas = new Canvas(bmpBase);
		
		int photoC = 0;
		for (EventCandidate  eventCandidate : EventCandidateContainer.getInstance().getAllEventsInContainer()) {
			
			for (Photo photo : eventCandidate.getEventPhotos()) {
				if (photoC > 8 )
					break;
				
				BitmapFactory.Options options = new BitmapFactory.Options();
				options.inPreferredConfig = Bitmap.Config.ARGB_8888;
				Bitmap bitmap = BitmapFactory.decodeFile(photo.getFilePath(), options);
				
				PixelPoint topleftPixelPoint = template.slots[i].getTopLeft();
				PixelPoint bottomRightPixelPoint =  slots[i++].getBottomRight();
				
				canvas.drawBitmap(bitmap, new Rect(template., top, right, bottom), dst, null)
			}
		}

		// Save Bitmap to File
		try
		{
		    fos = new FileOutputStream(SettingsActivity.ROOT + "\\Output");
		    bmpBase.compress(Bitmap.CompressFormat.PNG, 100, fos);

		    fos.flush();
		    fos.close();
		    fos = null;
		}
		catch (IOException e)
		{
		    e.printStackTrace();
		}
		finally
		{
		    if (fos != null)
		    {
		        try
		        {
		            fos.close();
		            fos = null;
		        }
		        catch (IOException e)
		        {
		            e.printStackTrace();
		        }
		    }
		}
	}

}

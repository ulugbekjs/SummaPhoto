import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;

import com.drew.imaging.ImageMetadataReader;
import com.drew.imaging.ImageProcessingException;
import com.drew.lang.GeoLocation;
import com.drew.metadata.Metadata;
import com.drew.metadata.exif.GpsDirectory;


public class Extractor {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		
		float[] arr = {32.073413611111114, 34.765015
				32.06501769444444, 34.78155136111111
				32.0650215, 34.78153991666667
				32.06502530555555, 34.781547527777775
				32.06501769444444, 34.78157425
				32.06497572222222, 34.781459805555556
				32.06497572222222, 34.78146361111111
				32.06480138888889, 34.781525555555554
				32.06497572222222, 34.78147886111111
				32.073013333333336, 34.764875
				32.073013333333336, 34.764875
				32.065006249999996, 34.78142163888889
				32.065052027777774, 34.78157041666667
				32.065006249999996, 34.78155897222222
				32.06584547222222, 34.777076694444446
				32.06584927777777, 34.777076694444446
				32.06570433333333, 34.77840041666666
				32.06573866666666, 34.77855680555555

		try {
			// file to write to
			File outFile = new File("/Users/yonatan/Documents/workspace/WorkshopRepository/Photos/locationList.txt");

			// if file doesnt exists, then create it
			if (!outFile.exists()) {
				outFile.createNewFile();
			}

			FileWriter	fw = new FileWriter(outFile.getAbsoluteFile());
			BufferedWriter bw = new BufferedWriter(fw);

			File directory = new File("/Users/yonatan/Documents/workspace/WorkshopRepository/photos/");
			for (File file : directory.listFiles()) {


				// extract photo metadata
				Metadata metadata = null;
				try {
					metadata = ImageMetadataReader.readMetadata(file);
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				} catch (ImageProcessingException e) {
					continue;
				}

				//get location
				GpsDirectory directory1 = metadata.getDirectory(GpsDirectory.class);

				GeoLocation location = directory1.getGeoLocation();
				if (location == null) { // photo has not location
					continue;
				}


				bw.write("pp=" + location.toString());
				bw.newLine();
			}


			bw.close();

			System.out.println("Done");

		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return;

		}

	}
}
